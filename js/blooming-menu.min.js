/**
 * blooming-menu - A configurable and animated radial menu for the web
 *
 * @version v1.0.2
 * @link https://github.com/caiogondim/blooming-menu
 * @author Caio Gondim <me@caiogondim.com> (http://caiogondim.com)
 * @license ISC
 */
!function() {
    "use strict";
    function e(n) {
        return this instanceof e ? (this.props = {},
        t.call(this, n),
        void (this.state = {
            isOpen: !1,
            isBeingAnimated: !1
        })) : new e(n)
    }
    function t(e) {
        if (e = e || {},
        void 0 === e.itemsNum)
            throw new Error("`opts.itemsNum` must be declared");
        this.props.itemsNum = e.itemsNum,
        this.props.injectBaseCSS = void 0 === e.injectBaseCSS ? !0 : !1,
        this.props.startAngle = void 0 === e.startAngle ? 90 : e.startAngle,
        this.props.endAngle = void 0 === e.endAngle ? 0 : e.endAngle,
        this.props.radius = e.radius || 80,
        this.props.itemAnimationDelay = e.itemAnimationDelay || .04,
        this.props.animationDuration = e.animationDuration || .4,
        this.props.fatherElement = e.fatherElement || document.body,
        this.props.elements = {},
        this.props.itemsName = e.itemsName || [],
        this.props.type = e.type || '';
        this.props.typeClass = e.typeClass || '';
        this.props.fontSize = e.fontSize || '32px',
        this.props.mainWidth = e.mainWidth || 50,
        this.props.itemWidth = e.itemWidth || 40,
        this.props.mainContent = e.mainContent || "",
        this.props.CSSClassPrefix = e.CSSClassPrefix || "blooming-menu__"
    }
    function n(e) {
        var t = e.CSSClassPrefix;
        e.elements.styleSheet = document.createElement("style"),
        document.head.appendChild(e.elements.styleSheet),
        e.elements.container = document.createElement("div"),
        e.elements.container.classList.add(t + p),
        e.elements.mainContainer = document.createElement("div"),
        e.elements.mainContainer.classList.add(t + d),
        e.elements.main = document.createElement("button"),
        e.elements.main.classList.add(t + u),
        e.elements.mainContent = document.createElement("span"),
        e.elements.mainContent.classList.add(t + f),
        e.elements.mainContent.innerHTML = e.mainContent,
        e.elements.mainContainer.appendChild(e.elements.main),
        e.elements.main.appendChild(e.elements.mainContent),
        e.elements.container.appendChild(e.elements.mainContainer),
        e.elements.items = [],
        e.elements.itemsContainer = document.createElement("ul"),
        e.elements.itemsContainer.classList.add(t + h),
        e.elements.container.appendChild(e.elements.itemsContainer);
        e.elements.container.style.opacity = 0;
        for (var n = 0; n < e.itemsNum; n++) {
            var i = document.createElement("li");
            if(e.itemsName[n] != undefined){
                i.setAttribute('action_name', e.itemsName[n]);
            }
            i.classList.add(t + w);
            var a = document.createElement("div");
            a.classList.add(t + b);
            var s = document.createElement("button");


            s.classList.add(t + x),
            a.appendChild(s),
            i.appendChild(a),
            e.elements.itemsContainer.appendChild(i),
            e.elements.items.push(i)
        }
        e.fatherElement.appendChild(e.elements.container);
        setTimeout(function(){
             //if(e.type != 'up'){ // 这个默认不显示
                  e.elements.container.style.opacity = 1;
            //}
        }, 2000);
       
    }
    function i(e) {
        var t = e.CSSClassPrefix
          , n = "";
        return n += "." + t + p + ",." + t + p + " * {  box-sizing: border-box;  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);  outline: none;  margin: 0;  padding: 0;}",
        n += "." + t + p + " { position: absolute; width: "+e.mainWidth+";  height: "+e.mainWidth+";  border-radius: 50%;  -webkit-user-select: none;  -moz-user-select: none;  -ms-user-select: none;  user-select: none;}",
        n += "." + t + p + " {  transition: box-shadow .28s cubic-bezier(.4,0,.2,1);  box-shadow: 0 2px 5px 0 rgba(0,0,0,.26);  width: "+e.itemWidth+";  height: "+e.itemWidth+";  border-radius: 50%;}",
        n += "." + t + u + " {  border-radius: 50%;  width: "+e.mainWidth+";  height: "+e.mainWidth+";  position: absolute;  z-index: 1;  cursor: pointer;  transition: all .28s cubic-bezier(.4,0,.2,1);  border: none;  background-color: #A974A2;  color: white;}",
        n += "." + t + u + ":hover {  box-shadow: 0 8px 17px 0 rgba(0,0,0,.2);}",
        n += "." + t + u + ".is-active { }",
        n += "." + t + f + " {  font-size: 1em;  line-height: 60%;  position: relative;}",
        n += "." + t + u + ".is-active ." + t + f + " {  -webkit-transform: rotate(45deg);  transform: rotate(45deg);}",
        n += "." + t + w + " {  position: absolute; transition:    -webkit-transform .28s cubic-bezier(.4,0,.2,1),    box-shadow .28s cubic-bezier(.4,0,.2,1),    opacity .28s cubic-bezier(.4,0,.2,1)  ;  transition:    transform .28s cubic-bezier(.4,0,.2,1),    box-shadow .28s cubic-bezier(.4,0,.2,1),    opacity .28s cubic-bezier(.4,0,.2,1)  ;  width: "+e.itemWidth+";  height: "+e.itemWidth+";  border-radius: 50%;}",
        n += "." + t + w + ":hover {  box-shadow: 0 8px 17px 0 rgba(0,0,0,.2);}",
        n += "." + t + w + ".is-selected:hover {  box-shadow: 0 0 0 0;  transition: box-shadow 0s;}",
        n += "." + t + h + " {  list-style-type: none;}",
        n += "." + t + b + " {  width: 100%;  height: 100%;  background-color: #6B9EB8;  border-radius: 50%;}",
        n += "." + t + x + " {  cursor: pointer;  border-radius: 50%;  border: none;  background-color: transparent;  width: 100%;  height: 100%;  box-shadow: 0 2px 5px 0 rgba(0,0,0,.26);  transition:    box-shadow .28s cubic-bezier(.4,0,.2,1),    opacity .28s cubic-bezier(.4,0,.2,1)  ;  background-size: 50%;  background-position: center center;  background-repeat: no-repeat;  opacity: 0.8;}"
    }
    function a(e, t) {
        t.innerHTML += e
    }
    function s(e) {
        var t = (e.endAngle - e.startAngle) / (e.itemsNum - 1)
          , n = e.startAngle
          , i = ""
          , a = e.CSSClassPrefix;

            var m,l,c,p,d,u,f,n = 0;
            var _x = 0, _jl;
            var count = 0;
        e.elements.items.forEach(function(s, r) {
            count++;
               m = e.radius * Math.cos(o(n))
              , l = e.radius * Math.sin(o(n))
              , c = Number(m.toFixed(2)) // x轴
              , p = Number(l.toFixed(2)) // y 轴
              , d = 1.2 * c // x 轴动画起始位置位置 100 从左 -100 从右
              , u = 1.2 * p // y 轴动画起始位置位置
              , f = 0 // x 轴动画终点位置位置
              , h = 0; // y 轴动画终点位置位置
            switch(e.type){
                case 'up':
                    if(count === 1){
                        _jl = 60;
                        //_x = _jl * 4;
                    }
                    _x -= 70;
                    p = _x; // 向上
                    d = 0;
                    c = 0;
                    break;
            }
            i += "@keyframes " + a + "expand-item-" + r + " {0% {transform: translate(" + f + "px, " + h + "px)}70% {transform: translate(" + d + "px, " + u + "px)}100% {transform: translate(" + c + "px, " + p + "px)}}@-webkit-keyframes " + a + "expand-item-" + r + " {0% {-webkit-transform: translate(" + f + "px, " + h + "px)}70% {-webkit-transform: translate(" + d + "px, " + u + "px)}100% {-webkit-transform: translate(" + c + "px, " + p + "px)}}",
            i += "@keyframes " + a + "contract-item-" + r + " {100% {transform: translate(" + f + "px, " + h + "px)}30% {transform: translate(" + d + "px, " + u + "px)}0% {transform: translate(" + c + "px, " + p + "px)}}@-webkit-keyframes " + a + "contract-item-" + r + " {100% {-webkit-transform: translate(" + f + "px, " + h + "px)}30% {-webkit-transform: translate(" + d + "px, " + u + "px)}0% {-webkit-transform: translate(" + c + "px, " + p + "px)}}",
            i += "." + a + w + ":nth-of-type(" + (r + 1) + ") {animation-delay: " + r * e.itemAnimationDelay + "s;animation-duration: " + e.animationDuration + "s;animation-timing-function: ease-out;animation-name: " + a + "contract-item-" + r + ";animation-fill-mode: backwards;}." + a + w + ":nth-of-type(" + (r + 1) + ") {-webkit-animation-delay: " + r * e.itemAnimationDelay + "s;-webkit-animation-duration: " + e.animationDuration + "s;-webkit-animation-timing-function: ease-out;-webkit-animation-name: " + a + "contract-item-" + r + ";-webkit-animation-fill-mode: backwards;}",
            i += "." + a + w + ".is-active:nth-of-type(" + (r + 1) + ") {animation-name: " + a + "expand-item-" + r + ";animation-fill-mode: forwards;}." + a + w + ".is-active:nth-of-type(" + (r + 1) + ") {-webkit-animation-name: " + a + "expand-item-" + r + ";-webkit-animation-fill-mode: forwards;}",
            i += "." + a + w + ":nth-of-type(" + (r + 1) + ").is-selected ." + a + b + " {animation-name: " + a + "select-item;animation-fill-mode: forwards;animation-duration: " + e.animationDuration + "s;animation-timing-function: ease-out;}." + a + w + ":nth-of-type(" + (r + 1) + ").is-selected ." + a + b + " {-webkit-animation-name: " + a + "select-item;-webkit-animation-fill-mode: forwards;-webkit-animation-duration: " + e.animationDuration + "s;-webkit-animation-timing-function: ease-out;}",
            i += "." + a + w + ":nth-of-type(" + (r + 1) + ").is-not-selected ." + a + b + " {animation-name: " + a + "not-select-item;animation-fill-mode: forwards;animation-duration: " + e.animationDuration + "s;animation-timing-function: ease-out;}." + a + w + ":nth-of-type(" + (r + 1) + ").is-not-selected ." + a + b + " {-webkit-animation-name: " + a + "not-select-item;-webkit-animation-fill-mode: forwards;-webkit-animation-duration: " + e.animationDuration + "s;-webkit-animation-timing-function: ease-out;}",
            n += t
        }),
        i += "@keyframes " + a + "select-item {0% {transform: scale(1);opacity: 1;}100% {transform: scale(2);opacity: 0;}}@-webkit-keyframes " + a + "select-item {0% {-webkit-transform: scale(1);opacity: 1;}100% {-webkit-transform: scale(2);opacity: 0;}}",
        i += "@keyframes " + a + "not-select-item {0% {transform: scale(1);opacity: 1;}100% {transform: scale(0);opacity: 0;}}@-webkit-keyframes " + a + "not-select-item {0% {-webkit-transform: scale(1);opacity: 1;}100% {-webkit-transform: scale(0);opacity: 0;}}",
        e.elements.styleSheet.innerHTML += i
    }
    function o(e) {
        return e * (Math.PI / 180)
    }
    function r(e) {
        e.container.parentNode.removeChild(e.container)
    }
    function m() {
        var e, t = document.createElement("fakeelement"), n = {
            animation: "animationend",
            webkitAnimation: "webkitAnimationEnd"
        };
        for (e in n)
            if (void 0 !== t.style[e])
                return n[e]
    }
    function l(e) {
        e.props.elements.main.addEventListener("click", function(t) {
            if(this.parentElement.parentElement.moved){
                this.parentElement.parentElement.moved = false;
                return;
            }
            // 如果没有再浏览图片,点击这个菜单浏览正在描绘的图片
            if(e.props.type == 'up'){
                if(g_v_paint.data != '' && !g_v_gallery_info.open){
                    var dom = getGridDom(g_v_paint.data.host, g_v_paint.data.id);
                    if(dom.length > 0){
                     loadGallery(dom.children(0));
                     return e.close();
                    }
                }
            }
            e.state.isOpen ? e.close() : e.open()
        })
        // e.props.elements.items.forEach(function(t, n) {
        //     t.addEventListener("click", function(t) {
        //        // e.selectItem(n)
        //     })
        // })
    }
    function c(e) {
        e.props.elements.main.removeEventListener("click"),
        e.props.elements.main.removeEventListener("touchstart")
    }
    var p = "container"
      , d = "main-container"
      , u = "main"
      , f = "main-content"
      , h = "items"
      , b = "item-btn-wrapper"
      , w = "item"
      , x = "item-btn";
    e.prototype.render = function() {
        var e = "";
        return n(this.props),
        this.props.injectBaseCSS && (e = i(this.props),
        a(e, this.props.elements.styleSheet)),
        s(this.props),
        l(this),
        this
    }
    ,
    e.prototype.remove = function() {
        return c(this),
        r(this),
        this
    }
    ,
    e.prototype.open = function() {
         g_v_selectMenu = this;
        return this.props.elements.main.classList.add("is-active"),
        this.props.elements.items.forEach(function(e) {
            e.style.display = "block",
            e.classList.remove("is-selected"),
            e.classList.add("is-active")
        }),
        this.state.isOpen = !0,
        this
    }
    ,
    e.prototype.close = function() {
        return this.props.elements.main.classList.remove("is-active"),
        this.props.elements.main.classList.add("is-inactive"),
        this.props.elements.items.forEach(function(e) {
            e.classList.remove("is-active"),
            e.classList.remove("is-selected"),
            e.classList.remove("is-not-selected")
        }),
        this.state.isOpen = !1,
        this
    }
    ,
    e.prototype.selectItem = function(e) {
        var t = this
          , n = document.querySelector(".blooming-menu__item-btn-wrapper");
          console.log(t);
          if(n != undefined){
             return n.addEventListener(m(), function() {
                t.close(),
                t.props.elements.items.forEach(function(e) {
                    e.style.display = "none"
                }),
                document.querySelector(".blooming-menu__item-btn-wrapper").removeEventListener(m())
            })
          }

        this.props.elements.items.forEach(function(t, n) {
            t.classList.add(n !== e ? "is-not-selected" : "is-selected")
        }),

        this.props.elements.main.classList.remove("is-active"),
        this
    }
    ,
    "undefined" != typeof module && "undefined" != typeof module.exports ? module.exports = e : "undefined" != typeof window && (window.BloomingMenu = e)
}();
